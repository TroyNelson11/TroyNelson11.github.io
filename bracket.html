<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Submit Team for GOOF Playoff Fantasy Football">
    <title>Submit Team - GOOF Playoff Fantasy Football</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="bracket.css">
    <script src="https://cdn.tailwindcss.com"></script>
 </head>
 <body>
     <!-- Navigation Bar -->
 
     <div class="nav-bar">
         <div class="navbar-brand">
             
             <div class="title"><img src="https://raw.githubusercontent.com/TroyNelson11/TroyNelson11.github.io/main/src/drawn_gator_logo.png" alt="Logo" class="logo">GOOF</div>
             <div class="brand-text">
                <span class="subtitle">Playoff Fantasy Football</span>
             </div>
         </div>
         <div class="navbar-nav">
             <div class="nav-item">
                 <a class="nav-link" href="submitTeam.html">Submit Team</a>
             </div>
             <div class="nav-item" hidden>
                 <a class="nav-link" href="scoring.html">Scoring</a>
             </div>
             <div class="nav-item">
                 <a class="nav-link" href="players.html">Players</a>
             </div>
             <div class="nav-item">
                <a class="nav-link" href="bracket.html">Bracket</a>
            </div>
         </div>
     </div>
     <div id="container" class="container">
        <div class="col-md-12">
            <div class="bracketcard">
                <div class="card-header flex items-center justify-center relative">
                    <span class="text-center w-1/2">Pick the AFC and NFC winners</span>
                    <a href="#" class="help-link text-sm" id="helpLink">What is this?</a>
                </div>
                
                <!-- Add Modal -->
                <div id="helpModal" class="modal hidden">
                    <div class="modal-content">
                        <span class="close-button">&times;</span>
                        <h2 class="font-bold mb-6">Is this apart of the competition?</h2>
                        <p>
                            <!-- Add your help text here when ready -->
                            
                            This is not apart of the competition, this 2025 NFL Playoff Bracket and is just meant to help you predict how many games a team might win / play this Postseason. The minus or plus number is the point spread for the home team. The over / under is the number of points expected in that game. Counting the number of times you see the logo will help count up how many games you predict a team will play. 
                        </p>
                    </div>
                </div>
                        <div>
                            <div class="bracket disable-image">
                                <div class="column one">

                                <div id="bracket-container" class="p-4 flex flex-col justify-start items-center"></div>
                                
                                </div>
                                <div class="column two">
                                
                                    <div id="bracket-container-2" class="p-4 flex flex-col justify-start items-center"></div>
                            
                                </div>
                                <div id = "c3" class="column three">
                                    <div id="bracket-container-3" class="flex flex-col items-center justify-start">
                                        <img 
                                            src="https://static.tvtropes.org/pmwiki/pub/images/super_bowl_lix_logosvg.png" 
                                            alt="Super Bowl LIX Logo" 
                                            class="w-40 max-w-xs h-auto mb-4"
                                            id="superbowl-logo">
                                    </div>
                                </div>       
                                <div class="column four">
                                    <div id="bracket-container-4" class="p-4 flex flex-col justify-center items-center"></div>
                                </div>
                                <div class="column five">
                                    <div id="bracket-container-5" class="p-4 flex flex-col justify-start items-center"></div>
                                </div>
                                    

                            </div>
                            <div id="teams-container" class="grid grid-cols-2 gap-4 p-4 hidden"></div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    
        <script>
             const playoffTeams = [ "KC", "BUF", "BAL", "HOU", "PIT", "LAC",  "DEN", "DET", "PHI", "LAR", "TB", "MIN",  "WAS", "GB"];
                const detailedPlayoffTeams = [
                    {
                        "abbreviation": "KC",
                        "name": "Kansas City Chiefs",
                        "logo": "https://nfldesigns.com/wp-content/uploads/2023/09/kansas-city-chiefs-logo-emblem-png.png",
                        "primary_color": "#C8102E", 
                        "secondary_color": "#FFB612",
                        "seed" : 1
                    },
                    {
                        "abbreviation": "BUF",
                        "name": "Buffalo Bills",
                        "logo": "https://content.sportslogos.net/logos/7/149/full/buffalo_bills_logo_primary_19747050.png",
                        "primary_color": "#003DA5", 
                        "secondary_color": "#C8102E",
                        "seed" : 2

                    },
                    {
                        "abbreviation": "BAL",
                        "name": "Baltimore Ravens",
                        "logo": "https://content.sportslogos.net/logos/7/153/full/baltimore_ravens_logo_primary_19996038.png",
                        "primary_color": "#3B0A45", 
                        "secondary_color": "#FFC20E",
                        "seed" : 5

                    },
                    {
                        "abbreviation": "HOU",
                        "name": "Houston Texans",
                        "logo": "https://content.sportslogos.net/logos/7/157/full/houston_texans_logo_primary_2024_sportslogosnet-5890.png",
                        "primary_color": "#03202F", 
                        "secondary_color": "#003A70",
                        "seed" : 4

                    },
                    {
                        "abbreviation": "PIT",
                        "name": "Pittsburgh Steelers",
                        "logo": "https://nfldesigns.com/wp-content/uploads/2023/09/pittsburgh-steelers-logo-emblem-png.png",
                        "primary_color": "#FFC20E", 
                        "secondary_color": "#000000",
                        "seed" : 3

                    },
                    {
                        "abbreviation": "DEN",
                        "name": "Denver Broncos",
                        "logo": "https://content.sportslogos.net/logos/7/161/full/denver_broncos_logo_primary_19973076.png",
                        "primary_color": "#FB4F14", 
                        "secondary_color": "#002244",
                        "seed" : 7

                    },
                    {
                        "abbreviation": "LAC",
                        "name": "Los Angeles Chargers",
                        "logo": "https://content.sportslogos.net/logos/7/6446/full/los_angeles_chargers_logo_primary_20203514.png",
                        "primary_color": "#0080C6", 
                        "secondary_color": "#FFC20E",
                        "seed" : 6

                    },
                    {
                        "abbreviation": "PHI",
                        "name": "Philadelphia Eagles",
                        "logo": "https://content.sportslogos.net/logos/7/167/full/philadelphia_eagles_logo_primary_19964867.png",
                        "primary_color": "#004C54", 
                        "secondary_color": "#A5ACAF",
                        "seed" : 2

                    },
                    {
                        "abbreviation": "LAR",
                        "name": "Los Angeles Rams",
                        "logo": "https://nfldesigns.com/wp-content/uploads/2023/09/los-angeles-rams-football-logo-png.png",
                        "primary_color": "#003594", 
                        "secondary_color": "#B3995D",
                        "seed" : 3

                    },
                    {
                        "abbreviation": "DET",
                        "name": "Detroit Lions",
                        "logo": "https://content.sportslogos.net/logos/7/170/full/detroit_lions_logo_primary_20172565.png",
                        "primary_color": "#0076B6", 
                        "secondary_color": "#A5ACAF",
                        "seed" : 1

                    },
                    {
                        "abbreviation": "MIN",
                        "name": "Minnesota Vikings",
                        "logo": "https://nfldesigns.com/wp-content/uploads/2023/09/minnesota-vikings-logo-emblem-png.png",
                        "primary_color": "#4F2765", 
                        "secondary_color": "#FFD100",
                        "seed" : 5

                    },
                    {
                        "abbreviation": "TB",
                        "name": "Tampa Bay Buccaneers",
                        "logo": "https://nfldesigns.com/wp-content/uploads/2023/09/tampa-bay-buccaneers-logo-emblem-png.png",
                        "primary_color": "#34302B", 
                        "secondary_color": "#A5ACAF",
                        "seed" : 9

                    },
                    {
                        "abbreviation": "WAS",
                        "name": "Washington Commanders",
                        "logo": "https://content.sportslogos.net/logos/7/6832/full/washington_commanders_logo_primary_20228587.png",
                        "primary_color": "#5A1414", 
                        "secondary_color": "#FFC20E",
                        "seed" : 7

                    },
                    {
                        "abbreviation": "GB",
                        "name": "Green Bay Packers",
                        "logo": "https://nfldesigns.com/wp-content/uploads/2023/09/green-bay-packers-symbol-logo-png.png",
                        "primary_color": "#203731", 
                        "secondary_color": "#FFB612",
                        "seed" : 6

                    },
                    {
                        "abbreviation": "ATL",
                        "name": "Atlanta Falcons",
                        "logo": "https://nfldesigns.com/wp-content/uploads/2023/06/atlanta-falcons-logo-hex-colors.png",
                        "primary_color": "#000",
                        "secondary_color": "#A71930",
                        "seed" : 4
                    },
                    {
                        "abbreviation": "ARI",
                        "name": "Arizona Cardinals",
                        "logo": "https://nfldesigns.com/wp-content/uploads/2023/06/arizona-cardinals-team-logo-png.png",
                        "primary_color": "#97233F",
                        "secondary_color": "#FFCB05",
                        "seed" : 10

                    },
                    {
                        "abbreviation": "SEA",
                        "name": "Seattle Seahawks",
                        "logo": "https://content.sportslogos.net/logos/7/180/full/seattle_seahawks_logo_primary_20121228.png",
                        "primary_color": "#002246",
                        "secondary_color": "#69BE28",
                        "seed" : 8

                    }
                ]
                const generateTeamDivs = (teams) => {
    const container = document.getElementById('teams-container'); // Replace with your container's ID

    const teamDivs = {};

teams.forEach((team) => {
    // Create the team div
    const teamDiv = document.createElement('div');
    teamDiv.className = 'team-div relative flex items-center justify-center w-24 h-12 border rounded shadow-md overflow-hidden';
    teamDiv.style.backgroundColor = team.primary_color;

    // Set initial result status to "lose"
    teamDiv.setAttribute('data-result', 'lose');
    teamDiv.setAttribute('data-seed', team.seed);
    teamDiv.setAttribute('data-team', team.abbreviation);

    // Team logo
    const logo = document.createElement('img');
    logo.src = team.logo;
    logo.alt = `${team.name} logo`;
    logo.className = 'absolute w-full h-auto object-cover'; // Keeps the aspect ratio while filling height

    // Append the logo to the team div
    teamDiv.appendChild(logo);

    // Append the team div to the container
    container.appendChild(teamDiv);

    // Store in a dictionary for reuse
    teamDivs[team.abbreviation] = teamDiv;
});


    return teamDivs; // Return the dictionary for further use
};
const addEventDelegation = () => {
    // Get all team divs in the container
    const teamDivs = document.querySelectorAll('.team-div');

    teamDivs.forEach((teamDiv) => {
        // Add click event listener to each team-div
        teamDiv.addEventListener('click', (e) => {
            e.stopPropagation();
            
            const match = teamDiv.closest('.match');
            if (!match) return;

            const matchTeamDivs = match.querySelectorAll('.team-div');
            let teamSeed = teamDiv.closest('.team-and-seed')
            let seed = teamSeed.querySelector('.seed')
            
            teamDiv.setAttribute('data-result', 'win');
            seed.style.color = 'black';
            seed.style.fontWeight = 'bold';

            matchTeamDivs.forEach((otherDiv) => {
                if (otherDiv !== teamDiv) {
                    otherDiv.setAttribute('data-result', 'lose');
                    let teamSeed = otherDiv.closest('.team-and-seed')
                    let seed = teamSeed.querySelector('.seed')
                    seed.style.color = 'rgb(107 114 128)';
                    seed.style.fontWeight = '';
                }
            });

            // Get the bracket container that the match is in
            const bracket = e.target.closest('.p-4');

            // Only update if it's the correct bracket
            if (bracket == document.getElementById("bracket-container") || 
                bracket == document.getElementById("bracket-container-5")) {
                updateSecondRoundMatchDetails();
            }
        });
    });
};
const addNewEventDelegation = () => {
    // Handle AFC bracket (bracket-container-2)
    let bracket2 = document.getElementById('bracket-container-2');
    if (bracket2) {
        const teamDivs = bracket2.querySelectorAll('.team-div');
        teamDivs.forEach((teamDiv) => {
            teamDiv.addEventListener('click', (e) => {
                e.stopPropagation();
                handleTeamClick(e, teamDiv, true); // true for AFC
            });
        });
    }

    // Handle NFC bracket (bracket-container-4)
    let bracket4 = document.getElementById('bracket-container-4');
    if (bracket4) {
        const teamDivs2 = bracket4.querySelectorAll('.team-div');
        teamDivs2.forEach((teamDiv) => {
            teamDiv.addEventListener('click', (e) => {
                e.stopPropagation();
                handleTeamClick(e, teamDiv, false); // false for NFC
            });
        });
    }
};

// New helper function to handle team clicks
const handleTeamClick = (e, teamDiv, isAFC) => {
    const match = teamDiv.closest('.match');
    if (!match) return;

    const matchTeamDivs = match.querySelectorAll('.team-div');
    let teamSeed = teamDiv.closest('.team-and-seed')
    let seed = teamSeed.querySelector('.seed')
    
    teamDiv.setAttribute('data-result', 'win');
    seed.style.color = 'black';
    seed.style.fontWeight = 'bold';

    matchTeamDivs.forEach((otherDiv) => {
        if (otherDiv !== teamDiv) {
            otherDiv.setAttribute('data-result', 'lose');
            let teamSeed = otherDiv.closest('.team-and-seed')
            let seed = teamSeed.querySelector('.seed')
            seed.style.color = 'rgb(107 114 128)';
            seed.style.fontWeight = '';
        }
    });

    // Only update the relevant rounds
    if (isAFC) {
        updateLateRounds(); // Only update AFC side
    } else {
        updateLateRounds(); // Only update NFC side
    }
};
const updateLateRounds = () => {
    // Check which bracket was clicked
    const clickedElement = event.target;
    const isAFCUpdate = clickedElement.closest('#bracket-container-2') !== null;
    const isNFCUpdate = clickedElement.closest('#bracket-container-4') !== null;

    // Handle AFC side
    if (isAFCUpdate) {
        const bracket2 = document.getElementById("bracket-container-2");
        if (!bracket2) return;

        const matches = Array.from(bracket2.querySelectorAll(".match"));
        const thirdMatch = matches[2];
        if (!thirdMatch) return;

        // Gather winners from the first two matches
        const winners = [];
        matches.slice(0,2).forEach((match) => {
            const winningTeam = match.querySelector('.team-div[data-result="win"]');
            if (winningTeam) {
                const td = winningTeam.cloneNode(true);
                td.setAttribute("data-result", "lose");
                winners.push({
                    teamDiv: td,
                    seed: parseInt(winningTeam.getAttribute("data-seed"), 10),
                });
            }
        });

        // Sort winners by seed
        winners.sort((a, b) => a.seed - b.seed);

        // Update the third match
        if (winners.length >= 2) {
            ["home", "away"].forEach((role, i) => {
                const teamSlot = thirdMatch.children[i];
                const currentTeam = winners[i];

                if (!currentTeam) return;

                const newTeamDiv = currentTeam.teamDiv.cloneNode(true);
                const newSeed = newTeamDiv.getAttribute("data-seed");

                teamSlot.querySelector(".team-div").replaceWith(newTeamDiv);

                const seedDiv = teamSlot.querySelector(".seed");
                if (seedDiv) {
                    seedDiv.textContent = `#${newSeed}`;
                    seedDiv.style.color = 'rgb(107 114 128)';
                    seedDiv.style.fontWeight = 'normal';
                }
            });
        }

        // Add click handlers for AFC championship game
        const teamDivs = Array.from(thirdMatch.querySelectorAll(".team-div"));
        teamDivs.forEach((teamDiv) => {
            teamDiv?.addEventListener("click", (e) => {
                handleChampionshipClick(e, teamDiv, true); // true for AFC
            });
        });
    }

    // Handle NFC side
    if (isNFCUpdate) {
        const bracket4 = document.getElementById("bracket-container-4");
        if (!bracket4) return;

        const matches = Array.from(bracket4.querySelectorAll(".match"));
        const thirdMatch = matches[2];
        if (!thirdMatch) return;

        // Gather winners from the first two matches
        const winners = [];
        matches.slice(0,2).forEach((match) => {
            const winningTeam = match.querySelector('.team-div[data-result="win"]');
            if (winningTeam) {
                const td = winningTeam.cloneNode(true);
                td.setAttribute("data-result", "lose");
                winners.push({
                    teamDiv: td,
                    seed: parseInt(winningTeam.getAttribute("data-seed"), 10),
                });
            }
        });

        // Sort winners by seed
        winners.sort((a, b) => a.seed - b.seed);

        // Update the third match
        if (winners.length >= 2) {
            ["home", "away"].forEach((role, i) => {
                const teamSlot = thirdMatch.children[i];
                const currentTeam = winners[i];

                if (!currentTeam) return;

                const newTeamDiv = currentTeam.teamDiv.cloneNode(true);
                const newSeed = newTeamDiv.getAttribute("data-seed");

                teamSlot.querySelector(".team-div").replaceWith(newTeamDiv);

                const seedDiv = teamSlot.querySelector(".seed");
                if (seedDiv) {
                    seedDiv.textContent = `#${newSeed}`;
                    seedDiv.style.color = 'rgb(107 114 128)';
                    seedDiv.style.fontWeight = 'normal';
                }
            });
        }

        // Add click handlers for NFC championship game
        const teamDivs = Array.from(thirdMatch.querySelectorAll(".team-div"));
        teamDivs.forEach((teamDiv) => {
            teamDiv?.addEventListener("click", (e) => {
                handleChampionshipClick(e, teamDiv, false); // false for NFC
            });
        });
    }
};


const addMatchDetails = (teamDiv, seed, spread, overUnder, isTopTeam) => {
    // Wrapper for team and details
    const matchRow = document.createElement('div');
    matchRow.className = 'match-row flex items-left justify-between';
    // Wrapper for team and seed
    const teamAndSeed = document.createElement('div');
    teamAndSeed.className = 'team-and-seed flex items-center';
    teamAndSeed.appendChild(teamDiv);
    // Seed
    if (seed) {
        const seedElement = document.createElement('div');
        seedElement.textContent = `#${seed}`;
        seedElement.className = 'seed text-s text-gray-500 p-2'; // Styled as a subtle label
        teamAndSeed.appendChild(seedElement);
    } else {
        const seedElement = document.createElement('div');
        seedElement.textContent = ``;
        seedElement.className = 'seed text-s text-gray-500 p-2'; // Styled as a subtle label
        teamAndSeed.appendChild(seedElement);
    }
    

    // Spread and O/U details (only shown once, on top team)
    let matchDetails = null;
    if (isTopTeam) {
        if (spread) {
            matchRow.className = 'match-row flex items-left justify-between mb-2';
            matchDetails = document.createElement('div');
            matchDetails.className = 'match-details text-s text-gray-700 flex flex-col items-end';

            const spreadElement = document.createElement('div');
            spreadElement.textContent = spread; // No label, just the value
            matchDetails.appendChild(spreadElement);

            const overUnderElement = document.createElement('div');
            overUnderElement.textContent = `O/U ${overUnder}`;
            matchDetails.appendChild(overUnderElement);
        }
        
    }

    // Append the team and seed to the row
    matchRow.appendChild(teamAndSeed);

    // Append match details to the row if it's the top team
    if (matchDetails) {
        matchRow.appendChild(matchDetails);
    }

    return matchRow;
};


const updateSecondRoundMatchDetails = () => {
    // Get the bracket container that triggered the update
    const bracketContainer1 = document.getElementById('bracket-container');
    const bracketContainer5 = document.getElementById('bracket-container-5');
    
    // Check which bracket triggered the update
    const clickedElement = event.target;
    const isAFCUpdate = clickedElement.closest('#bracket-container') !== null;
    const isNFCUpdate = clickedElement.closest('#bracket-container-5') !== null;

    // Handle AFC side (brackets 1->2) only if AFC was clicked
    if (isAFCUpdate) {
        const teamDivs = Array.from(bracketContainer1.querySelectorAll('.team-div[data-result="win"]'));
        if (teamDivs.length >= 3) {
            teamDivs.sort((a, b) => {
                const seedA = parseInt(a.getAttribute('data-seed'), 10);
                const seedB = parseInt(b.getAttribute('data-seed'), 10);
                return seedB - seedA;
            });
            secondRoundMatchDetails[0].away = teamDivs[0].getAttribute('data-team');
            secondRoundMatchDetails[0].awayseed = teamDivs[0].getAttribute('data-seed');
            secondRoundMatchDetails[1].away = teamDivs[1].getAttribute('data-team');
            secondRoundMatchDetails[1].awayseed = parseInt(teamDivs[1].getAttribute('data-seed'), 10);
            secondRoundMatchDetails[1].home = teamDivs[2].getAttribute('data-team');
            secondRoundMatchDetails[1].homeseed = parseInt(teamDivs[2].getAttribute('data-seed'), 10);
            
            updateAFCMatches();
        }
    }

    // Handle NFC side (brackets 5->4) only if NFC was clicked
    if (isNFCUpdate) {
        const teamDivs2 = Array.from(bracketContainer5.querySelectorAll('.team-div[data-result="win"]'));
        if (teamDivs2.length >= 3) {
            teamDivs2.sort((a, b) => {
                const seedA = parseInt(a.getAttribute('data-seed'), 10);
                const seedB = parseInt(b.getAttribute('data-seed'), 10);
                return seedB - seedA;
            });
            secondRoundMatchDetails[2].away = teamDivs2[0].getAttribute('data-team');
            secondRoundMatchDetails[2].awayseed = parseInt(teamDivs2[0].getAttribute('data-seed'), 10);
            secondRoundMatchDetails[3].away = teamDivs2[1].getAttribute('data-team');
            secondRoundMatchDetails[3].awayseed = parseInt(teamDivs2[1].getAttribute('data-seed'), 10);
            secondRoundMatchDetails[3].home = teamDivs2[2].getAttribute('data-team');
            secondRoundMatchDetails[3].homeseed = parseInt(teamDivs2[2].getAttribute('data-seed'), 10);
            
            updateNFCMatches();
        }
    }
};

// Split updateMatches into two functions
const updateAFCMatches = () => {
    const container = document.getElementById('bracket-container-2');
    if (!container) return;

    const matches = Array.from(container.querySelectorAll('.match'));
    
    matches.slice(0,2).forEach((match, matchIndex) => {
        const m = secondRoundMatchDetails[matchIndex];
        if (!m) return;

        // Update home team
        const homeDiv = match.children[0].querySelector('.team-div');
        if (homeDiv && m.home) {
            const teams = generateTeamDivs(detailedPlayoffTeams);
            const newHomeDiv = teams[m.home].cloneNode(true);
            newHomeDiv.setAttribute("data-result", "lose");
            homeDiv.replaceWith(newHomeDiv);
            
            // Reset seed styles
            const homeSeed = match.children[0].querySelector('.seed');
            if (homeSeed) {
                homeSeed.textContent = "#" + m.homeseed;
                homeSeed.style.color = 'rgb(107 114 128)';
                homeSeed.style.fontWeight = 'normal';
            }
        }

        // Update away team
        const awayDiv = match.children[1].querySelector('.team-div');
        if (awayDiv && m.away) {
            const teams = generateTeamDivs(detailedPlayoffTeams);
            const newAwayDiv = teams[m.away].cloneNode(true);
            newAwayDiv.setAttribute("data-result", "lose");
            awayDiv.replaceWith(newAwayDiv);
            
            // Reset seed styles
            const awaySeed = match.children[1].querySelector('.seed');
            if (awaySeed) {
                awaySeed.textContent = "#" + m.awayseed;
                awaySeed.style.color = 'rgb(107 114 128)';
                awaySeed.style.fontWeight = 'normal';
            }
        }
    });
    addNewEventDelegation();
};

const updateNFCMatches = () => {
    const container = document.getElementById('bracket-container-4');
    if (!container) return;

    const matches = Array.from(container.querySelectorAll('.match'));
    
    matches.slice(0,2).forEach((match, matchIndex) => {
        const m = secondRoundMatchDetails[matchIndex + 2]; // Offset by 2 for NFC matches
        if (!m) return;

        // Update home team
        const homeDiv = match.children[0].querySelector('.team-div');
        if (homeDiv && m.home) {
            const teams = generateTeamDivs(detailedPlayoffTeams);
            const newHomeDiv = teams[m.home].cloneNode(true);
            newHomeDiv.setAttribute("data-result", "lose");
            homeDiv.replaceWith(newHomeDiv);
            
            // Reset seed styles
            const homeSeed = match.children[0].querySelector('.seed');
            if (homeSeed) {
                homeSeed.textContent = "#" + m.homeseed;
                homeSeed.style.color = 'rgb(107 114 128)';
                homeSeed.style.fontWeight = 'normal';
            }
        }

        // Update away team
        const awayDiv = match.children[1].querySelector('.team-div');
        if (awayDiv && m.away) {
            const teams = generateTeamDivs(detailedPlayoffTeams);
            const newAwayDiv = teams[m.away].cloneNode(true);
            newAwayDiv.setAttribute("data-result", "lose");
            awayDiv.replaceWith(newAwayDiv);
            
            // Reset seed styles
            const awaySeed = match.children[1].querySelector('.seed');
            if (awaySeed) {
                awaySeed.textContent = "#" + m.awayseed;
                awaySeed.style.color = 'rgb(107 114 128)';
                awaySeed.style.fontWeight = 'normal';
            }
        }
    });
    addNewEventDelegation();
};

let match_details = [
    {
        "home": "BUF",
        "away": "DEN",
        "homeseed": 2,
        "awayseed": 7,
        "spread": -7.5,
        "total": 45.5
    },
    {
        "home": "BAL",
        "away": "LAC",
        "homeseed": 3,
        "awayseed": 6,
        "spread": -3.5,
        "total": 41.5
    },
    {
        "home": "HOU",
        "away": "PIT",
        "homeseed": 4,
        "awayseed": 5,
        "spread": "+5.5",
        "total": 49.5
    },
    {
        "home": "PHI",
        "away": "GB",
        "homeseed": 2,
        "awayseed": 7,
        "spread": -5.5,
        "total": 47.5
    },
    {
        "home": "LAR",
        "away": "WAS",
        "homeseed": 3,
        "awayseed": 6,
        "spread": "+3",
        "total": 46.5
    },
    {
        "home": "TB",
        "away": "MIN",
        "homeseed": 4,
        "awayseed": 5,
        "spread": "+2.5",
        "total": 46.5
    }
];
let secondRoundMatchDetails = [
    // AFC
    {
        "home": "KC",
        "away": null,
        "homeseed": 1,
        "awayseed": null,
        "spread": null, 
        "total": null
    },
    {
        "home": null,
        "away": null,
        "homeseed": null,
        "awayseed": null,
        "spread": null,
        "total": null
    },

    // NFC
    {
        "home": "DET",
        "away": null,
        "homeseed": 1,
        "awayseed": null,
        "spread": null, 
        "total": null
    },
    {
        "home": null,
        "away": null,
        "homeseed": null,
        "awayseed": null,
        "spread": null,
        "total": null
    },
    
];
const updateMatches = () => {
    const containers = [
        document.getElementById('bracket-container-2'),
        document.getElementById('bracket-container-4')

    ];

    containers.forEach((container, index) => {
        if (!container) {
            console.warn(`Container ${index + 2} does not exist.`);
            return;
        }

        // Find the matches inside the container
        const matches = Array.from(container.querySelectorAll('.match'));
        let i = 0;

        matches.slice(0,2).forEach((match, matchIndex) => {
            // Update home team

            const m = secondRoundMatchDetails[matchIndex + (2*index)];
            if (!m) {
            console.warn(`No match details for container ${index + 2}.`);
            return;
            }
            console.log((index*2) + matchIndex)
            const homeDiv = match.children[0].querySelector('.team-div'); // First child's team-div
            if (homeDiv &&  m.home) {
                const teams = generateTeamDivs(detailedPlayoffTeams)
                const newHomeDiv = teams[m.home].cloneNode(true);
                newHomeDiv.setAttribute("data-result", "lose")
                homeDiv.replaceWith(newHomeDiv);
                const homeSeed = match.children[0].querySelector('.seed'); // First child's team-div
                homeSeed.textContent = "#" + m.homeseed;

            }

            const awayDiv = match.children[1].querySelector('.team-div'); // Second child's team-div
            if (awayDiv && m.away) {
                const teams = generateTeamDivs(detailedPlayoffTeams)
                const newAwayDiv = teams[m.away].cloneNode(true);
                newAwayDiv.setAttribute("data-result", "lose")

                awayDiv.replaceWith(newAwayDiv);
                const awaySeed = match.children[1].querySelector('.seed'); // First child's team-div
                awaySeed.textContent ="#" +  m.awayseed;

                }
            i = i + 1;

        });
    });
    addNewEventDelegation();
};
// Usage
document.addEventListener('DOMContentLoaded', () => {
    const teamDivs = generateTeamDivs(detailedPlayoffTeams);
    // Example of reusing team divs for a match in the bracket
    const bracketContainer = document.getElementById('bracket-container'); // Replace with your bracket container's ID
    bracketContainer.appendChild(createGameTitle("Wildcard"))
    const spacer = document.createElement('div');
    spacer.className = 'spacer flex flex-col items-left rounded-md p-2 m-1 shadow-md invisible';
    for (const m of match_details.slice(0,3)) {
        const match = document.createElement('div');
        match.className = 'match flex flex-col items-left rounded-md p-2 shadow-lg';

        // Add team divs with details
        match.appendChild(addMatchDetails(teamDivs[m.home].cloneNode(true), m.homeseed, m.spread, m.total, true)); // Kansas City Chiefs
        match.appendChild(addMatchDetails(teamDivs[m.away].cloneNode(true), m.awayseed, m.spread*-1, m.total, false)); // Buffalo Bills

        bracketContainer.appendChild(match);
        bracketContainer.appendChild(spacer.cloneNode(true)); // Add spacer after each match

    }
    // Example of reusing team divs for a match in the bracket
    const bracketContainer2 = document.getElementById('bracket-container-2'); // Replace with your bracket container's ID
    bracketContainer2.appendChild(createGameTitle("Divisional"))

    
    for (const m of secondRoundMatchDetails.slice(0,2)) {
        const match = document.createElement('div');
        match.className = 'match flex flex-col items-left rounded-md p-2 shadow-lg';

        // Add team divs with details, for bye teams insert empty placeholders
        match.appendChild(addMatchDetails(teamDivs[m.home] ? teamDivs[m.home].cloneNode(true) : createEmptyTeamDiv(), m.homeseed, m.spread, m.total, true)); // Away team

        match.appendChild(addMatchDetails(teamDivs[m.away] ? teamDivs[m.away].cloneNode(true) : createEmptyTeamDiv(), m.awayseed, m.spread, m.total, false)); // Away team
        bracketContainer2.appendChild(spacer.cloneNode(true))

        bracketContainer2.appendChild(match);


    }
    bracketContainer2.appendChild(spacer.cloneNode(true))
    bracketContainer2.appendChild(createGameTitle("AFC", "#D50A0A"))
    bracketContainer2.appendChild(createEmptyMatch())

    const bracketContainer3 = document.getElementById('bracket-container-3'); // Replace with your bracket container's ID
    bracketContainer3.appendChild(createEmptyMatch())
    bracketContainer3.appendChild(spacer.cloneNode(true))



    const bracketContainer4 = document.getElementById('bracket-container-4'); // Replace with your bracket container's ID
    bracketContainer4.appendChild(createGameTitle("Divisional"))

    for (const m of secondRoundMatchDetails.slice(2,4)) {
        const match = document.createElement('div');
        match.className = 'match flex flex-col items-left rounded-md p-2 shadow-lg';

        // Add team divs with details, for bye teams insert empty placeholders
        match.appendChild(addMatchDetails(teamDivs[m.home] ? teamDivs[m.home].cloneNode(true) : createEmptyTeamDiv(), m.homeseed, m.spread, m.total, true)); // Away team

        match.appendChild(addMatchDetails(teamDivs[m.away] ? teamDivs[m.away].cloneNode(true) : createEmptyTeamDiv(), m.awayseed, m.spread, m.total, false)); // Away team
        bracketContainer4.appendChild(spacer.cloneNode(true))

        bracketContainer4.appendChild(match);

    }
    bracketContainer4.appendChild(spacer.cloneNode(true))
    bracketContainer4.appendChild(createGameTitle("NFC", "#013369"))
    bracketContainer4.appendChild(createEmptyMatch())
    const bracketContainer5 = document.getElementById('bracket-container-5'); // Replace with your bracket container's ID
    bracketContainer5.appendChild(createGameTitle("Wildcard"))

    for (const m of match_details.slice(3,6)) {
        const match = document.createElement('div');
        match.className = 'match flex flex-col items-left rounded-md p-2 shadow-lg';

        // Add team divs with details
        match.appendChild(addMatchDetails(teamDivs[m.home].cloneNode(true), m.homeseed, m.spread, m.total, true)); // Kansas City Chiefs
        match.appendChild(addMatchDetails(teamDivs[m.away].cloneNode(true), m.awayseed, m.spread*-1, m.total, false)); // Buffalo Bills

        bracketContainer5.appendChild(match);
        bracketContainer5.appendChild(spacer.cloneNode(true)); // Add spacer after each match


    }
    addEventDelegation();
    rearrangeBracketContainers()

});

// Function to create an empty team div for "BYE" teams
function createEmptyTeamDiv() {
    const emptyDiv = document.createElement('div');
    emptyDiv.className = 'team-div empty-team relative flex items-left w-24 h-12 border rounded shadow-md bg-gray-300';
    const placeholder = document.createElement('div');
    placeholder.className = 'text-center text-gray-600';
    placeholder.textContent = '';
    emptyDiv.appendChild(placeholder);
    return emptyDiv;
}
function createEmptyMatch() {
    const match = document.createElement('div');
    match.className = 'match empty-match flex flex-col items-left rounded-md p-1 m-1 shadow-md';

    // Add team divs with details, for bye teams insert empty placeholders
    match.appendChild(addMatchDetails(createEmptyTeamDiv(), null, null, null, true));
    match.appendChild(addMatchDetails(createEmptyTeamDiv(), null, null, null, false));

    return match;
}
    
function createGameTitle(title, backgroundColor = null) {
    const titleDiv = document.createElement('div');
    titleDiv.className = 'game-title flex items-center justify-center w-40 h-auto border-b-2 border-gray-300 mb-4';

    // Apply background color if provided, or default to gray
    titleDiv.style.backgroundColor = backgroundColor || '#f3f4f6'; // Default to gray-100

    const titleText = document.createElement('h2');
    titleText.className = 'text-2xl font-bold text-center uppercase';

    // Set text color based on background color
    titleText.style.color = backgroundColor ? '#ffffff' : '#1f2937'; // Default to gray-800

    titleText.textContent = title;

    titleDiv.appendChild(titleText);
    return titleDiv;
}

function rearrangeBracketContainers() {
  const columnOne = document.querySelector('.column.one');
  const columnTwo = document.querySelector('.column.two');
  const columnThree = document.querySelector('.column.three');
  const columnFour = document.querySelector('.column.four');
  const columnFive = document.querySelector('.column.five');

  // Get bracket containers from columns
  const bracketContainerOne = document.querySelector('#bracket-container');
  const bracketContainerTwo = document.querySelector('#bracket-container-2');
  const bracketContainerThree = document.querySelector('#bracket-container-3');
  const bracketContainerFour = document.querySelector('#bracket-container-4');
  const bracketContainerFive = document.querySelector('#bracket-container-5');

  // Helper function to replace the last game title with "Conference"
  function replaceLastGameTitleWithConference(container) {
    const gameTitles = container.querySelectorAll('.game-title');

    if (gameTitles.length > 0) {
      const lastGameTitle = gameTitles[gameTitles.length - 1];
      const titleText = lastGameTitle.querySelector('h2');
      titleText.className = 'text-2xl font-bold text-center uppercase';
      titleText.textContent = 'Conference'; // Replace with "Conference"
      titleText.style.color = '#1f2937'
      lastGameTitle.appendChild(titleText);

      lastGameTitle.style.backgroundColor = '#f3f4f6'; // Default to gray-100

    }
  }

  if (window.innerWidth <= 768) {
    // Remove any divs with the class "game-title" from column five and column four
    console.log('test');
    function removeElementsByClass(containerId, className) {
      const container = document.querySelector(containerId);
      if (container) {
        const elementsToRemove = container.querySelectorAll(`.${className}`);
        elementsToRemove.forEach(element => element.remove());
        console.log(`Removed ${className} divs from ${containerId}`);
      }
    }
    // Remove "invisible" divs from #bracket-container-2 and #bracket-container-4
    removeElementsByClass('#bracket-container-2', 'spacer');
    removeElementsByClass('#bracket-container-4', 'spacer');

    // Replace the last game title in bracket-container-2 and bracket-container-4 with "Conference"
    replaceLastGameTitleWithConference(bracketContainerTwo);
    replaceLastGameTitleWithConference(bracketContainerFour);

        // Check if the "AFC" title is already in columnOne
    if (bracketContainerOne.children[0].children[0].textContent != "AFC") {
        bracketContainerOne.prepend(createGameTitle("AFC", "#D50A0A")); // Prepend "AFC" title to column one
    } else {
        console.warn(bracketContainerOne.children[0].children[0].textContent);
    }

    // Check if the "NFC" title is already in bracketContainerFive
    if (bracketContainerFive.children[0].children[0].textContent != "NFC") {
        bracketContainerFive.prepend(createGameTitle("NFC", "#013369")); // Prepend "NFC" title to column two
    } else {
        console.warn("NFC title already exists in bracketContainerFive.");
    }


    // Move bracket-container-5 to be the first child of column two
    columnTwo.prepend(bracketContainerFive);

    // Move bracket-container-2 to column one
    columnOne.appendChild(bracketContainerTwo);

    // Move bracket-container-4 into column two (this remains as is)
    columnTwo.appendChild(bracketContainerFour);

    // Move bracket-container-3 underneath both columns and center it
    if (bracketContainerThree) {
      const parentContainer = document.querySelector('.bracketcard'); // The parent container (or adjust to your needs)
      
      // Ensure bracket-container-3 is the last child of the parent container
      parentContainer.appendChild(bracketContainerThree);

      // Apply centering styles directly to bracket-container-3
      bracketContainerThree.style.display = 'flex';
      bracketContainerThree.style.justifyContent = 'center';
      bracketContainerThree.style.width = '100%';
    }
    const bracket = document.querySelector('.bracket');

    // Helper function to remove specific columns
    function removeColumns(bracket, columnClasses) {
        columnClasses.forEach((columnClass) => {
        const column = bracket.querySelector(`.${columnClass}`);
        if (column) {
            column.remove();
            console.log(`Removed column: ${columnClass}`);
        }
        });
    }

    if (bracket) {
        // Specify the columns to remove
        const columnsToRemove = ['three', 'four', 'five'];
        removeColumns(bracket, columnsToRemove);
    }
  } 
}

// Helper function for championship game clicks
const handleChampionshipClick = (e, teamDiv, isAFC) => {
    e.stopPropagation();
    
    const match = teamDiv.closest(".match");
    if (!match) return;

    // Toggle the data-result for the clicked team-div
    teamDiv.setAttribute("data-result", "win");
    const teamSeed = teamDiv.closest(".team-and-seed");
    const seed = teamSeed.querySelector(".seed");
    seed.style.color = "black";
    seed.style.fontWeight = "bold";

    // Set the other team-div's data-result to lose
    const matchTeamDivs = match.querySelectorAll(".team-div");
    matchTeamDivs.forEach((otherDiv) => {
        if (otherDiv !== teamDiv) {
            otherDiv.setAttribute("data-result", "lose");
            const otherSeed = otherDiv.closest(".team-and-seed").querySelector(".seed");
            otherSeed.style.color = "rgb(107 114 128)";
            otherSeed.style.fontWeight = "";
        }
    });

    // Update Super Bowl bracket
    const superbowl_bracket = document.getElementById("bracket-container-3");
    if (superbowl_bracket) {
        let clone = teamDiv.cloneNode(true);
        clone.setAttribute("data-result", "lose");
        // Set text color to white
        clone.style.color = "white";
        
        const superbowl = superbowl_bracket.querySelectorAll('.match')[0];
        const index = isAFC ? 0 : 1;  // AFC goes in first slot, NFC in second
        
        // Update the team and seed
        superbowl.children[index].querySelector(".team-div").replaceWith(clone);
        const seedDiv = superbowl.children[index].querySelector(".seed");
        if (seedDiv) {
            seedDiv.textContent = `#${teamDiv.getAttribute('data-seed')}`;
            seedDiv.style.color = "white";  // Set seed text to white
        }

        // Add Super Bowl click handler
        clone.addEventListener('click', handleSuperBowlClick);
    }
};

// Helper function for Super Bowl clicks
const handleSuperBowlClick = (e) => {
    e.stopPropagation();
    const teamDiv = e.currentTarget;
    
    const superbowl_teams = document.getElementById("bracket-container-3")
        .querySelectorAll('.team-div');
    
    // Set clicked team as winner
    teamDiv.setAttribute('data-result', 'win');
    
    // Set other team as loser
    superbowl_teams.forEach((otherDiv) => {
        if (otherDiv !== teamDiv) {
            otherDiv.setAttribute('data-result', 'lose');
        }
    });
};

// Modal functionality
document.addEventListener('DOMContentLoaded', function() {
    const modal = document.getElementById('helpModal');
    const helpLink = document.getElementById('helpLink');
    const closeButton = document.querySelector('.close-button');

    helpLink.addEventListener('click', function(e) {
        e.preventDefault();
        modal.classList.add('show');
    });

    closeButton.addEventListener('click', function() {
        modal.classList.remove('show');
    });

    // Close modal when clicking outside
    window.addEventListener('click', function(e) {
        if (e.target === modal) {
            modal.classList.remove('show');
        }
    });

    // Prevent scrolling when modal is open
    modal.addEventListener('show', function() {
        document.body.style.overflow = 'hidden';
    });

    modal.addEventListener('hide', function() {
        document.body.style.overflow = 'auto';
    });
});

        </script>
    </div>
    
</body>
</html>
